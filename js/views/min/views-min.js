function init(){var t=new AppView}var app=app||{},DATE=new Date,FORMATTEDDATE=DATE.getMonth()+1+"/"+DATE.getDate()+"/"+DATE.getFullYear(),FoodItemView=Backbone.View.extend({tagName:"li",events:{"click button.libut":"destroy"},destroy:function(){this.remove(),this.model.destroy(),$("#new-food").focus()},render:function(){return this.model.get("date")==$(".gldate").val()&&this.$el.html("<button id='destroy' class='libut'></button>    "+this.model.get("servings")+" servings of "+this.model.get("food")+"<span class='calContainer  pull-right'><span class='DOMcals'>"+this.model.get("calories")+"</span> calories  </span><br>"),this}}),AppView=Backbone.View.extend({el:$("#foodapp"),collection:foodCollection,events:{"click button#add-food":"createFood","click button#reset":"reset","keyup #new-food":"autoComplete"},initialize:function(){var t=this;this.list=$("#food-list"),this.input=$("#new-food"),this.servings=$("#servings"),this.calories=$("#calories"),this.glDate=$(".gldate"),this.input.focus(),this.listenTo(this.collection,"sync",this.totalCal),this.listenTo(this.collection,"add",this.addOne),this.listenTo(this.collection,"remove",this.totalCal),$(".gldate").glDatePicker({onClick:function(e,i,o,l){e.val(o.toLocaleDateString()),t.filter()}}),$(".gldate").val(FORMATTEDDATE)},addOne:function(t){var e=new FoodItemView({model:t});this.list.append(e.render().el),this.totalCal()},createFood:function(){return this.input.val()&&this.servings.val()?(this.collection.create({date:this.glDate.val(),food:this.input.val(),servings:$("#servings").val(),calories:Math.round($("#calories").val())*$("#servings").val()}),this.input.val(""),this.servings.val(""),void this.calories.val("")):void alert("please enter all required fields")},autoComplete:function(t){if(13===t.keyCode)this.createFood();else if(27===t.keyCode)$("#autocomplete").html("");else if(this.input.val()){var e=this.input.val().replace(" ","%20");$.get("https://api.nutritionix.com/v1_1/search/"+e+"?cal_min=0&cal_max=50000&fields=item_name%2Cbrand_name%2Citem_id%2Cbrand_id&appId=8b44227f&appKey=979a61790b4e55a8d4bc92c954038963",function(t){if($("#autocomplete").html(""),0!==t.length){for(var e=0;e<t.hits.length;e++)$("#autocomplete").append("<li id="+e+">"+t.hits[e].fields.item_name+", by "+t.hits[e].fields.brand_name+"</li><br>");$("#autocomplete").click(function(e){$("#new-food").val(e.target.innerText),$.get("https://api.nutritionix.com/v1_1/item?id="+t.hits[e.target.id]._id+"&appId=8b44227f&appKey=979a61790b4e55a8d4bc92c954038963",function(t){var e=t.nf_calories;$("#calories").val(e)}).fail(function(){$("#calories").val("No Calories Retrieved; please enter manually")}),$("#autocomplete").html("")})}}).fail(function(){$("#autocomplete").html("")})}else $("#autocomplete").html("")},reset:function(){confirm("are you SURE you want to reset the database?")&&(this.collection.reset(),this.list.html(""),this.input.focus())},filter:function(t){var e=$(".gldate").val();this.rerender(this.collection.byDate(e))},rerender:function(t){return $("#food-list").html(""),t.each(function(t){var e=new FoodItemView({model:t,collection:this.collection});$("#food-list").append(e.render().el)}),this.totalCal(),this},totalCal:function(){var t=0;$(".DOMcals").each(function(){t+=parseFloat($(this).text())}),$(".todaysDate").text($(".gldate").val()),$(".calTotal").text(t)}});$(function(){init()});